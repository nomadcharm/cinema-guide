import{r as n,A as U,i as q,g as I,k as f,j as s,F as i,R as r,m as D,n as N,o as C,p as _,t as G,s as O,U as V,q as z}from"./index-CuQd2nTu.js";import{p as b}from"./icon-person-CSVaiHAu.js";const K=()=>{var h,g,x,j,w;const[m,l]=n.useState(""),[y,u]=n.useState(!1),{setAuthMode:S}=n.useContext(U),{register:t,handleSubmit:M,reset:P,formState:{errors:a},clearErrors:R}=q({resolver:G(V)}),F=I({mutationFn:e=>O(e.email,e.name,e.surname,e.password),onSuccess(){u(!0),P()},onError(e){l(e.message),u(!1)}},z),E=e=>{if(e.password!==e.confirmPassword){l("Пароли не совпадают");return}const{confirmPassword:B,...A}=e;F.mutate(A)},[p,k]=f(),[d,v]=f(),o=e=>{l(""),R(e)},c=n.useRef(null);return n.useEffect(()=>{c.current&&c.current.focus()},[c.current]),s.jsx("div",{className:"registration",children:y?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",onClick:()=>S("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:M(E),children:[s.jsxs(i,{errorMessage:(h=a.email)==null?void 0:h.message,children:[s.jsx(r,{className:"input-icon",src:D}),s.jsx("input",{...t("email"),ref:e=>{t("email").ref(e),c.current=e},type:"text",placeholder:"Электронная почта",onChange:()=>o("email")})]}),s.jsxs(i,{errorMessage:(g=a.name)==null?void 0:g.message,children:[s.jsx(r,{className:"input-icon",src:b}),s.jsx("input",{...t("name"),type:"text",placeholder:"Имя",onChange:()=>o("name")})]}),s.jsxs(i,{errorMessage:(x=a.surname)==null?void 0:x.message,children:[s.jsx(r,{className:"input-icon",src:b}),s.jsx("input",{...t("surname"),type:"text",placeholder:"Фамилия",onChange:()=>o("surname")})]}),s.jsxs(i,{errorMessage:(j=a.password)==null?void 0:j.message,children:[s.jsx(r,{className:"input-icon",src:N}),s.jsx("input",{...t("password"),type:p?"text":"password",placeholder:"Пароль",onChange:()=>o("password")}),s.jsx("button",{className:"registration__show-password",type:"button",onClick:()=>k(),children:s.jsx(r,{className:"password-icon",src:p?C:_})})]}),s.jsxs(i,{errorMessage:(w=a.confirmPassword)==null?void 0:w.message,children:[s.jsx(r,{className:"input-icon",src:N}),s.jsx("input",{...t("confirmPassword"),type:d?"text":"password",placeholder:"Подтвердить пароль",onChange:()=>o("confirmPassword")}),s.jsx("button",{className:"registration__show-password",type:"button",onClick:()=>v(),children:s.jsx(r,{className:"password-icon",src:d?C:_})})]}),m&&s.jsx("p",{className:"error-message",children:m}),s.jsx("button",{className:"button button-primary registration__submit",type:"submit",children:"Создать аккаунт"})]})]})})};export{K as default};
