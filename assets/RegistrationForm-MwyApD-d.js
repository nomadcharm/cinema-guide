import{r as x,A as b,j as s,g as F,h as M}from"./index-CdRiQ81p.js";import{R as o}from"./logo-nlpE4Fyl.js";import{u as P,F as n,e as R,k as h,t as S}from"./AuthModal-DC0CZzbW.js";import{u as E,B as v,q as A}from"./Button-Bd71XVgg.js";import{p as j}from"./icon-person-CSVaiHAu.js";const G=()=>{var l,u,p,g,d;const[f,m]=x.useState(!1),{setAuthMode:w}=x.useContext(b),{register:a,handleSubmit:N,reset:y,formState:{errors:r},setError:i,clearErrors:t}=P({defaultValues:{email:"",name:"",surname:"",password:"",confirmPassword:""},resolver:S(M)}),c=E({mutationFn:e=>F(e.email,e.name,e.surname,e.password),onSuccess(){m(!0),y()},onError(e){i("root",{type:"server",message:e.message}),e.name!=="AuthError"&&i("email",{type:"manual",message:e.message}),m(!1)}},A),_=e=>{if(e.password!==e.confirmPassword){i("root",{type:"password",message:"Пароли не совпадают"});return}const{confirmPassword:k,...C}=e;c.mutate(C)};return s.jsx("div",{className:"registration",children:f?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",type:"button",onClick:()=>w("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:N(_),children:[s.jsxs(n,{errorMessage:(l=r.email)==null?void 0:l.message,children:[s.jsx(o,{className:"input-icon",src:R}),s.jsx("input",{...a("email"),type:"text",autoFocus:!0,placeholder:"Электронная почта",onChange:()=>t("email")})]}),s.jsxs(n,{errorMessage:(u=r.name)==null?void 0:u.message,children:[s.jsx(o,{className:"input-icon",src:j}),s.jsx("input",{...a("name"),type:"text",placeholder:"Имя",onChange:()=>t("name")})]}),s.jsxs(n,{errorMessage:(p=r.surname)==null?void 0:p.message,children:[s.jsx(o,{className:"input-icon",src:j}),s.jsx("input",{...a("surname"),type:"text",placeholder:"Фамилия",onChange:()=>t("surname")})]}),s.jsxs(n,{errorMessage:(g=r.password)==null?void 0:g.message,children:[s.jsx(o,{className:"input-icon",src:h}),s.jsx("input",{...a("password"),type:"password",placeholder:"Пароль",onChange:()=>t("password")})]}),s.jsxs(n,{errorMessage:(d=r.confirmPassword)==null?void 0:d.message,children:[s.jsx(o,{className:"input-icon",src:h}),s.jsx("input",{...a("confirmPassword"),type:"password",placeholder:"Подтвердить пароль",onChange:()=>t("confirmPassword")})]}),r.root&&s.jsx("p",{className:"error-message",children:r.root.message}),s.jsx(v,{className:"button button-primary registration__submit",isLoading:c.isPending,children:"Создать аккаунт"})]})]})})};export{G as default};
