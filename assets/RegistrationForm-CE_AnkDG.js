import{r as d,A as C,u as M,a as F,j as s,F as o,R as n,e as R,k as x,t as S,b as E,U as P,q as v}from"./index-Bm5h_YyU.js";import{p as h}from"./icon-person-CSVaiHAu.js";const q=()=>{var c,l,u,p,g;const[j,m]=d.useState(!1),{setAuthMode:f}=d.useContext(C),{register:a,handleSubmit:w,reset:N,formState:{errors:r},setError:i,clearErrors:t}=M({defaultValues:{email:"",name:"",surname:"",password:"",confirmPassword:""},resolver:S(P)}),y=F({mutationFn:e=>E(e.email,e.name,e.surname,e.password),onSuccess(){m(!0),N()},onError(e){i("root",{type:"server",message:e.message}),e.name!=="AuthError"&&i("email",{type:"manual",message:e.message}),m(!1)}},v),b=e=>{if(e.password!==e.confirmPassword){i("root",{type:"password",message:"Пароли не совпадают"});return}const{confirmPassword:A,..._}=e;y.mutate(_)};return s.jsx("div",{className:"registration",children:j?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",onClick:()=>f("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:w(b),children:[s.jsxs(o,{errorMessage:(c=r.email)==null?void 0:c.message,children:[s.jsx(n,{className:"input-icon",src:R}),s.jsx("input",{...a("email"),type:"text",placeholder:"Электронная почта",onChange:()=>t("email")})]}),s.jsxs(o,{errorMessage:(l=r.name)==null?void 0:l.message,children:[s.jsx(n,{className:"input-icon",src:h}),s.jsx("input",{...a("name"),type:"text",placeholder:"Имя",onChange:()=>t("name")})]}),s.jsxs(o,{errorMessage:(u=r.surname)==null?void 0:u.message,children:[s.jsx(n,{className:"input-icon",src:h}),s.jsx("input",{...a("surname"),type:"text",placeholder:"Фамилия",onChange:()=>t("surname")})]}),s.jsxs(o,{errorMessage:(p=r.password)==null?void 0:p.message,children:[s.jsx(n,{className:"input-icon",src:x}),s.jsx("input",{...a("password"),type:"password",placeholder:"Пароль",onChange:()=>t("password")})]}),s.jsxs(o,{errorMessage:(g=r.confirmPassword)==null?void 0:g.message,children:[s.jsx(n,{className:"input-icon",src:x}),s.jsx("input",{...a("confirmPassword"),type:"password",placeholder:"Подтвердить пароль",onChange:()=>t("confirmPassword")})]}),r.root&&s.jsx("p",{className:"error-message",children:r.root.message}),s.jsx("button",{className:"button button-primary registration__submit",type:"submit",children:"Создать аккаунт"})]})]})})};export{q as default};
