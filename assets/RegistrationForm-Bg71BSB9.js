import{r as c,A,i as U,g as q,k as w,j as s,F as n,R as r,m as D,n as N,o as f,p as C,t as G,s as I,U as O,q as V}from"./index-Bdi-bgfM.js";import{p as _}from"./icon-person-CSVaiHAu.js";const J=()=>{var d,h,g,x,j;const[l,i]=c.useState(""),[b,m]=c.useState(!1),{setAuthMode:y}=c.useContext(A),{register:a,handleSubmit:S,reset:M,formState:{errors:t},clearErrors:P}=U({resolver:G(O)}),F=q({mutationFn:e=>I(e.email,e.name,e.surname,e.password),onSuccess(){m(!0),M()},onError(e){i(e.message),m(!1)}},V),R=e=>{if(e.password!==e.confirmPassword){i("Пароли не совпадают");return}const{confirmPassword:z,...v}=e;F.mutate(v)},[p,k]=w(),[u,E]=w(),o=e=>{i(""),P(e)};return s.jsx("div",{className:"registration",children:b?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",onClick:()=>y("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:S(R),children:[s.jsxs(n,{errorMessage:(d=t.email)==null?void 0:d.message,children:[s.jsx(r,{className:"input-icon",src:D}),s.jsx("input",{...a("email"),type:"text",placeholder:"Электронная почта",onChange:()=>o("email")})]}),s.jsxs(n,{errorMessage:(h=t.name)==null?void 0:h.message,children:[s.jsx(r,{className:"input-icon",src:_}),s.jsx("input",{...a("name"),type:"text",placeholder:"Имя",onChange:()=>o("name")})]}),s.jsxs(n,{errorMessage:(g=t.surname)==null?void 0:g.message,children:[s.jsx(r,{className:"input-icon",src:_}),s.jsx("input",{...a("surname"),type:"text",placeholder:"Фамилия",onChange:()=>o("surname")})]}),s.jsxs(n,{errorMessage:(x=t.password)==null?void 0:x.message,children:[s.jsx(r,{className:"input-icon",src:N}),s.jsx("input",{...a("password"),type:p?"text":"password",placeholder:"Пароль",onChange:()=>o("password")}),s.jsx("button",{className:"registration__show-password",type:"button",onClick:()=>k(),children:s.jsx(r,{className:"password-icon",src:p?f:C})})]}),s.jsxs(n,{errorMessage:(j=t.confirmPassword)==null?void 0:j.message,children:[s.jsx(r,{className:"input-icon",src:N}),s.jsx("input",{...a("confirmPassword"),type:u?"text":"password",placeholder:"Подтвердить пароль",onChange:()=>o("confirmPassword")}),s.jsx("button",{className:"registration__show-password",type:"button",onClick:()=>E(),children:s.jsx(r,{className:"password-icon",src:u?f:C})})]}),l&&s.jsx("p",{className:"error-message",children:l}),s.jsx("button",{className:"button button-primary registration__submit",type:"submit",children:"Создать аккаунт"})]})]})})};export{J as default};
