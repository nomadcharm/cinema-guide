import{r as m,A as S,u as F,a as R,j as s,F as n,R as o,e as E,k as h,t as P,b as k,U as v,q as A}from"./index-DBaO7MLV.js";import{p as j}from"./icon-person-CSVaiHAu.js";const D=()=>{var u,p,g,d,x;const[c,i]=m.useState(""),[f,l]=m.useState(!1),{setAuthMode:N}=m.useContext(S),{register:r,handleSubmit:w,reset:b,formState:{errors:a},clearErrors:C}=F({defaultValues:{email:"",name:"",surname:"",password:""},resolver:P(v)}),_=R({mutationFn:e=>k(e.email,e.name,e.surname,e.password),onSuccess(){l(!0),b()},onError(e){i(e.message),l(!1)}},A),y=e=>{if(e.password!==e.confirmPassword){i("Пароли не совпадают");return}const{confirmPassword:U,...M}=e;_.mutate(M)},t=e=>{i(""),C(e)};return s.jsx("div",{className:"registration",children:f?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",onClick:()=>N("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:w(y),children:[s.jsxs(n,{errorMessage:(u=a.email)==null?void 0:u.message,children:[s.jsx(o,{className:"input-icon",src:E}),s.jsx("input",{...r("email"),type:"text",placeholder:"Электронная почта",onChange:()=>t("email")})]}),s.jsxs(n,{errorMessage:(p=a.name)==null?void 0:p.message,children:[s.jsx(o,{className:"input-icon",src:j}),s.jsx("input",{...r("name"),type:"text",placeholder:"Имя",onChange:()=>t("name")})]}),s.jsxs(n,{errorMessage:(g=a.surname)==null?void 0:g.message,children:[s.jsx(o,{className:"input-icon",src:j}),s.jsx("input",{...r("surname"),type:"text",placeholder:"Фамилия",onChange:()=>t("surname")})]}),s.jsxs(n,{errorMessage:(d=a.password)==null?void 0:d.message,children:[s.jsx(o,{className:"input-icon",src:h}),s.jsx("input",{...r("password"),type:"password",placeholder:"Пароль",onChange:()=>t("password")})]}),s.jsxs(n,{errorMessage:(x=a.confirmPassword)==null?void 0:x.message,children:[s.jsx(o,{className:"input-icon",src:h}),s.jsx("input",{...r("confirmPassword"),type:"password",placeholder:"Подтвердить пароль",onChange:()=>t("confirmPassword")})]}),c&&s.jsx("p",{className:"error-message",children:c}),s.jsx("button",{className:"button button-primary registration__submit",type:"submit",children:"Создать аккаунт"})]})]})})};export{D as default};
