import{r as x,A as b,j as s,h as F,i as M}from"./index-BcBjp_A4.js";import{R as n}from"./logo-7AIRQdur.js";import{u as P,F as i,e as R,k as h,t as S}from"./AuthModal-C1YgqOyi.js";import{u as E,q as v}from"./queryClient-i1xqYovM.js";import{p as j}from"./icon-person-CSVaiHAu.js";import{B as A}from"./Button-C9pxYuvz.js";const L=()=>{var c,u,p,g,d;const[f,m]=x.useState(!1),{setAuthMode:w}=x.useContext(b),{register:t,handleSubmit:y,reset:N,formState:{errors:a},setError:r,clearErrors:o}=P({defaultValues:{email:"",name:"",surname:"",password:"",confirmPassword:""},resolver:S(M)}),l=E({mutationFn:e=>F(e.email,e.name,e.surname,e.password),onSuccess(){m(!0),N()},onError(e){r("root",{type:"server",message:e.message}),e.name!=="AuthError"&&(r("email",{type:"manual",message:e.message}),r("name",{type:"manual",message:e.message}),r("surname",{type:"manual",message:e.message}),r("password",{type:"manual",message:e.message}),r("confirmPassword",{type:"manual",message:e.message})),m(!1)}},v),_=e=>{if(e.password!==e.confirmPassword){r("root",{type:"password",message:"Пароли не совпадают"});return}const{confirmPassword:k,...C}=e;l.mutate(C)};return s.jsx("div",{className:"registration",children:f?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",type:"button",onClick:()=>w("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:y(_),children:[s.jsxs(i,{errorMessage:(c=a.email)==null?void 0:c.message,children:[s.jsx(n,{className:"input-icon",src:R}),s.jsx("input",{...t("email"),type:"text",autoFocus:!0,placeholder:"Электронная почта",onChange:()=>o("email")})]}),s.jsxs(i,{errorMessage:(u=a.name)==null?void 0:u.message,children:[s.jsx(n,{className:"input-icon",src:j}),s.jsx("input",{...t("name"),type:"text",placeholder:"Имя",onChange:()=>o("name")})]}),s.jsxs(i,{errorMessage:(p=a.surname)==null?void 0:p.message,children:[s.jsx(n,{className:"input-icon",src:j}),s.jsx("input",{...t("surname"),type:"text",placeholder:"Фамилия",onChange:()=>o("surname")})]}),s.jsxs(i,{errorMessage:(g=a.password)==null?void 0:g.message,children:[s.jsx(n,{className:"input-icon",src:h}),s.jsx("input",{...t("password"),type:"password",placeholder:"Пароль",onChange:()=>o("password")})]}),s.jsxs(i,{errorMessage:(d=a.confirmPassword)==null?void 0:d.message,children:[s.jsx(n,{className:"input-icon",src:h}),s.jsx("input",{...t("confirmPassword"),type:"password",placeholder:"Подтвердить пароль",onChange:()=>o("confirmPassword")})]}),a.root&&s.jsx("p",{className:"error-message",children:a.root.message}),s.jsx(A,{className:"button button-primary registration__submit",isLoading:l.isPending,children:"Создать аккаунт"})]})]})})};export{L as default};
