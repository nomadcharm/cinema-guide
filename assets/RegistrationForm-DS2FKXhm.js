import{r as i,A as w,i as S,g as F,j as s,F as n,R as o,k as R,m as d,t as C,n as I,U as E,q as P}from"./index-C7uohwjw.js";import{p as j}from"./icon-person-CSVaiHAu.js";const U=()=>{var l,u,p,x,g;const[c,r]=i.useState(""),[h,m]=i.useState(!1),{setAuthMode:N}=i.useContext(w),{register:t,handleSubmit:f,reset:_,formState:{errors:a}}=S({resolver:C(E)}),b=F({mutationFn:e=>I(e.email,e.name,e.surname,e.password),onSuccess(){m(!0),_()},onError(e){r(e.message),m(!1)}},P),M=e=>{if(e.password!==e.confirmPassword){r("Пароли не совпадают");return}const{confirmPassword:k,...y}=e;b.mutate(y)};return s.jsx("div",{className:"registration",children:h?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",onClick:()=>N("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:f(M),children:[s.jsxs(n,{errorMessage:(l=a.email)==null?void 0:l.message,children:[s.jsx(o,{className:"input-icon",src:R}),s.jsx("input",{...t("email"),type:"text",placeholder:"Электронная почта",onInput:()=>r("")})]}),s.jsxs(n,{errorMessage:(u=a.name)==null?void 0:u.message,children:[s.jsx(o,{className:"input-icon",src:j}),s.jsx("input",{...t("name"),type:"text",placeholder:"Имя",onInput:()=>r("")})]}),s.jsxs(n,{errorMessage:(p=a.surname)==null?void 0:p.message,children:[s.jsx(o,{className:"input-icon",src:j}),s.jsx("input",{...t("surname"),type:"text",placeholder:"Фамилия",onInput:()=>r("")})]}),s.jsxs(n,{errorMessage:(x=a.password)==null?void 0:x.message,children:[s.jsx(o,{className:"input-icon",src:d}),s.jsx("input",{...t("password"),type:"text",placeholder:"Пароль",onInput:()=>r("")})]}),s.jsxs(n,{errorMessage:(g=a.confirmPassword)==null?void 0:g.message,children:[s.jsx(o,{className:"input-icon",src:d}),s.jsx("input",{...t("confirmPassword"),type:"text",placeholder:"Подтвердить пароль",onInput:()=>r("")})]}),c&&s.jsx("p",{className:"error-message",children:c}),s.jsx("button",{className:"button button-primary registration__submit",children:"Создать аккаунт"})]})]})})};export{U as default};
