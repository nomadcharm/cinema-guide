import{r as d,A as C,j as s,g as F,h as M}from"./index-CccpuDcG.js";import{R as o}from"./logo-m9zWLd2D.js";import{u as R,F as n,e as S,k as x,t as E}from"./AuthModal-D-ubGceG.js";import{u as P,q as v}from"./queryClient-9nTjZ4io.js";import{p as h}from"./icon-person-CSVaiHAu.js";const G=()=>{var c,l,u,p,g;const[j,m]=d.useState(!1),{setAuthMode:f}=d.useContext(C),{register:t,handleSubmit:w,reset:N,formState:{errors:r},setError:i,clearErrors:a}=R({defaultValues:{email:"",name:"",surname:"",password:"",confirmPassword:""},resolver:E(M)}),y=P({mutationFn:e=>F(e.email,e.name,e.surname,e.password),onSuccess(){m(!0),N()},onError(e){i("root",{type:"server",message:e.message}),e.name!=="AuthError"&&i("email",{type:"manual",message:e.message}),m(!1)}},v),_=e=>{if(e.password!==e.confirmPassword){i("root",{type:"password",message:"Пароли не совпадают"});return}const{confirmPassword:A,...b}=e;y.mutate(b)};return s.jsx("div",{className:"registration",children:j?s.jsxs("div",{className:"registration-complete",children:[s.jsx("h3",{className:"registration__title",children:"Регистрация завершена"}),s.jsx("p",{className:"registration__text",children:"Используйте вашу электронную почту для входа"}),s.jsx("button",{className:"button button-primary login__submit",onClick:()=>f("login"),children:"Войти"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h3",{className:"registration__title",children:"Регистрация"}),s.jsxs("form",{className:"registration__form",onSubmit:w(_),children:[s.jsxs(n,{errorMessage:(c=r.email)==null?void 0:c.message,children:[s.jsx(o,{className:"input-icon",src:S}),s.jsx("input",{...t("email"),type:"text",autoFocus:!0,placeholder:"Электронная почта",onChange:()=>a("email")})]}),s.jsxs(n,{errorMessage:(l=r.name)==null?void 0:l.message,children:[s.jsx(o,{className:"input-icon",src:h}),s.jsx("input",{...t("name"),type:"text",placeholder:"Имя",onChange:()=>a("name")})]}),s.jsxs(n,{errorMessage:(u=r.surname)==null?void 0:u.message,children:[s.jsx(o,{className:"input-icon",src:h}),s.jsx("input",{...t("surname"),type:"text",placeholder:"Фамилия",onChange:()=>a("surname")})]}),s.jsxs(n,{errorMessage:(p=r.password)==null?void 0:p.message,children:[s.jsx(o,{className:"input-icon",src:x}),s.jsx("input",{...t("password"),type:"password",placeholder:"Пароль",onChange:()=>a("password")})]}),s.jsxs(n,{errorMessage:(g=r.confirmPassword)==null?void 0:g.message,children:[s.jsx(o,{className:"input-icon",src:x}),s.jsx("input",{...t("confirmPassword"),type:"password",placeholder:"Подтвердить пароль",onChange:()=>a("confirmPassword")})]}),r.root&&s.jsx("p",{className:"error-message",children:r.root.message}),s.jsx("button",{className:"button button-primary registration__submit",type:"submit",children:"Создать аккаунт"})]})]})})};export{G as default};
